## redis 进阶

### 1. 缓存穿透、击穿、雪崩

- 缓存穿透：redis 的缓存没有命中，向持久层数据库查询也没有，查询失败，缓存也无法更新；当大量用户产生上述情况就发生了缓存穿透

  解决方案：

  - 布隆过滤器，先对能够查询的数据进行 hash，先在控制层进行校验
  - 即使是空对象也进行缓存，但是会产生空值的键，会浪费内存，即使设置了过期时间，但也会使缓存和数据库的数据有一段时间不一致

  

- 缓存击穿：一个 key 被高频查询，当 key 失效瞬间，持续大并发直接查询数据库，导致访问速度降低

  解决方案：

  - 热点数据永不过期
  - 加互斥锁，每个 key 只有一个线程去访问



- 缓存雪崩：某一个时间段，缓存集中过期，redis 宕机

  解决方案：

  - redis 高可用，增设从机
  - 限流降级，缓存失效后，通过加锁或者队列来限制缓存的线程数量
  - 数据预热，在正式部署前，先把高频数据先加载到缓存中