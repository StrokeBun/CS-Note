## 安卓基础

### 1. Activity

#### 1.1 生命周期

安卓使用 **返回栈** 保存 Activity，新建一个 Activity 则压入栈，按返回键或者调用 finish() 则将栈顶元素弹出。

<img src="img/返回栈示意图.jpg" style="zoom:70%">

Activity 的活动状态：

- 运行：位于栈顶时即为运行状态。系统最不会回收该状态的 Activity。
- 暂停：不位于栈顶，但仍然可见，举例：不占满屏幕的对话框。只有在内存极低情况下系统才进行回收。
- 停止：不位于栈顶，并且完全不可见。系统会为该状态的 Activity 保存相应的状态和成员变量，但不可靠，可能被回收。
- 销毁：已经从栈中移除，系统最倾向于回收该状态的 Activity。

Activity 的回调方法：

- 完整生存期：
  - onCreate() ：第一次被创建时调用，应使用该方法完成加载布局、绑定事件等；
  - onDestroy()：销毁时调用，释放内存。
- 可见生存期：
  - onStart()：不可见变为可见时调用，加载资源；
  - onStop()：活动完全不可见时调用，释放资源。启动的新活动是对话框式的活动，onStop() 不会执行，onPause() 执行。
- 前台生存期：
  - onResume()：准备好和用户进行交互时调用，位于栈顶且处于运行状态；
  - onPause()：启动或恢复另一个 Activity 时调用，常用于释放资源、保存关键数据；

- onRestart()：停止状态变为运行状态之前调用，即活动被重新启动前。

<img src="img/Activity生命周期.jpg" style="zoom:80%">

#### 1.2 启动模式

Activity 的四种启动模式

- standard：默认启动模式，启动一个新活动后入栈并返回栈顶，每次启动都会重新创建一个该活动的实例；

- singleTop：如果栈顶已经是该活动，直接使用而不会创建新活动；

- singleTask：栈中指挥保存一个该活动实例；

- singleInstance：启用一个新的栈来管理这个活动，用于共享活动。

  <img src="img/singleInstance示意图.jpg" style="zoom:70%">